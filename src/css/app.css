@import 'tailwindcss';
@import './animations.css';
@import './video-mask.css';

@font-face {
  font-family: 'Salernomi J';
  src: url('../../assets/9SALERNO.TTF') format('truetype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* ============================================
   DESIGN TOKENS
   ============================================ */
@theme {
  --font-sans: 'Segoe UI', 'Inter', sans-serif;
  --font-serif: 'Salernomi J', 'Times New Roman', Georgia, serif;
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;

  --color-hud: #78fff5;
  --color-warm: #ffc864;
  --color-hot: #64ff96;
  --color-error: #ff7878;
  --color-danger: #ff5050;
  --color-dark: #0a0e12;
  --color-darker: #080c10;
  --color-darkest: #020617;
  --color-close-hover: #dc3232;

  /* Text colors */
  --color-text-primary: rgba(248, 248, 245, 0.95);
  --color-text-secondary: rgba(245, 249, 255, 0.95);
  --color-text-muted: rgba(238, 244, 252, 0.68);
  --color-text-dim: rgba(200, 200, 200, 0.7);
  --color-text-inverse: rgba(18, 22, 30, 0.95);
  --color-text-hud: rgba(230, 255, 255, 0.9);
  --color-text-error: rgba(255, 100, 100, 0.9);

  /* Surface/background colors */
  --color-surface-btn-primary: rgba(248, 248, 245, 0.95);
  --color-surface-btn-secondary: rgba(10, 16, 28, 0.38);
  --color-surface-card: rgba(4, 7, 12, 0.5);
  --color-surface-control: rgba(2, 5, 10, 0.54);

  /* Border colors */
  --color-border-light: rgba(245, 249, 255, 0.8);
  --color-border-medium: rgba(245, 249, 255, 0.52);

  /* Font sizes */
  --text-body: clamp(22px, 2.1cqw, 34px);
  --text-heading: clamp(40px, 4.4cqw, 68px);
  --text-caption: clamp(16px, 1.3cqw, 22px);
  --text-small: clamp(14px, 1.15cqw, 19px);

  /* Spacing */
  --spacing-card-w: 7.8cqw;
  --spacing-btn-w: 13cqw;
  --spacing-btn-min-w: 150px;

  /* Border radius */
  --radius-card: 0.35cqw;
  --radius-panel: 0.4cqw;
  --radius-lg: 0.5cqw;

  /* Letter spacing */
  --tracking-wide: 0.05em;
  --tracking-wider: 0.1em;
  --tracking-widest: 0.2em;
}

/* ============================================
   CSS CUSTOM PROPERTIES (JS-driven values)
   ============================================ */
:root {
  /* Edge alignment tokens */
  --edge-left: 4%;
  --edge-right: 4%;
  --edge-top: 6%;
  --edge-top-lg: 8%;
  --edge-top-xl: 12%;
  --edge-bottom: 4.2%;
  --edge-bottom-lg: 8%;

  /* JS-driven values */
  --app-background-blur: 6px;
  --portal-offset-x: 0px;
  --portal-offset-y: 0px;
  --portal-glow-rgb: 140, 206, 244;
  --bg-parallax-x: 0px;
  --bg-parallax-y: 0px;
  --portal-hover-scale: 1;
  --portal-tilt: -8deg;
  --portal-center-x: 50cqw;
  --portal-center-y: 50cqh;
  --portal-settings-left: 20%;
  --menu-right-edge: var(--edge-right);
  --pause-bottom-baseline: var(--edge-bottom-lg);
}
@layer base {
  :root {
    font-family: var(--font-sans);
    font-size: 14px;
    line-height: 1.4;
    font-weight: 400;
    color: #f0f0f0;
    background-color: transparent;
    font-synthesis: none;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
  }

  html,
  body {
    width: 100%;
    height: 100%;
    background: transparent;
    overflow: hidden;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  html::-webkit-scrollbar,
  body::-webkit-scrollbar {
    display: none;
  }

  #root {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: transparent;
  }

  a {
    color: #24c8db;
    text-decoration: none;
  }
  a:hover {
    color: #6ee7ef;
  }

  input,
  button {
    border-radius: 6px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 0.5em 1em;
    font-size: 1em;
    font-family: inherit;
    color: #fff;
    background-color: rgba(255, 255, 255, 0.05);
    transition: all 0.2s ease;
  }

  input:focus {
    outline: none;
    border-color: rgba(0, 255, 255, 0.4);
    box-shadow: 0 0 8px rgba(0, 255, 255, 0.2);
  }

  button {
    cursor: pointer;
    background: rgba(0, 255, 255, 0.1);
    border-color: rgba(0, 255, 255, 0.3);
  }

  button:hover {
    background: rgba(0, 255, 255, 0.2);
    border-color: rgba(0, 255, 255, 0.5);
    box-shadow: 0 0 12px rgba(0, 255, 255, 0.3);
  }
}

/* ============================================
   RESIDUAL COMPONENT CSS
   Patterns that can't be expressed as Tailwind utilities:
   pseudo-elements, complex state selectors, animation bindings,
   container query units, scrollbar styling, etc.
   ============================================ */
@layer components {
  /* --- HOLO-FRAME LAYOUT --- */
  .holo-frame {
    container-type: size;
    scrollbar-width: none;
    -ms-overflow-style: none;
    user-select: none;
  }
  .holo-frame::-webkit-scrollbar {
    display: none;
  }

  .holo-frame-inner {
    aspect-ratio: 16 / 9;
    width: clamp(400px, min(100cqw, calc(100cqh * 16 / 9)), 100cqw);
    height: clamp(225px, min(100cqh, calc(100cqw * 9 / 16)), 100cqh);
    container-type: size;
    container-name: holo-frame;
  }

  /* Content area streaming reveal */
  .holo-frame .content-area.streaming-reveal {
    overflow: hidden;
    clip-path: circle(0% at 50% 50%);
    -webkit-clip-path: circle(0% at 50% 50%);
    animation: streamingCircularReveal 1000ms cubic-bezier(0.12, 0.78, 0.6, 1) forwards;
    will-change: clip-path;
  }

  /* --- BACKGROUND SLIDESHOW --- */
  .app-background-slide {
    position: absolute;
    inset: 0;
    opacity: 0;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    filter: blur(var(--app-background-blur, 6px));
    transition: filter 0.8s ease;
    transform: translate(var(--bg-parallax-x, 0px), var(--bg-parallax-y, 0px)) scale(1.05);
  }
  .app-background-slide.active {
    opacity: 1;
  }

  .app-background-transition-slide {
    position: absolute;
    inset: 0;
    z-index: 1;
    opacity: 0;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    filter: blur(var(--app-background-blur, 6px));
    transform: translate(var(--bg-parallax-x, 0px), var(--bg-parallax-y, 0px)) scale(1.05);
    clip-path: ellipse(6.6% 9.5% at 50% 53%);
    -webkit-clip-path: ellipse(6.6% 9.5% at 50% 53%);
    animation: portalBgReveal 960ms cubic-bezier(0.16, 0.86, 0.18, 1) forwards;
    will-change: clip-path, transform;
  }

  .app-background-scrim {
    position: absolute;
    inset: 0;
    z-index: 2;
    opacity: 1;
    background:
      radial-gradient(circle at center, rgba(2, 6, 23, 0.05) 0%, rgba(2, 6, 23, 0.65) 100%),
      linear-gradient(to bottom, rgba(2, 6, 23, 0.2) 0%, rgba(2, 6, 23, 0.55) 100%);
  }

  /* --- PORTAL PREVIEW --- */
  .portal-preview {
    transform: translate(calc(-50% + var(--portal-offset-x, 0px)), calc(-50% + var(--portal-offset-y, 0px)))
      scale(var(--portal-hover-scale));
    transition:
      left 0.48s cubic-bezier(0.2, 0.74, 0.26, 1),
      top 0.48s cubic-bezier(0.2, 0.74, 0.26, 1),
      transform 0.18s ease-out,
      filter 0.32s ease;
  }
  .portal-preview:hover {
    --portal-hover-scale: 1.05;
  }
  .portal-preview:focus-visible {
    outline: 2px solid rgba(var(--portal-glow-rgb, 140, 206, 244), 0.7);
    outline-offset: 4px;
  }

  .portal-preview-shell {
    border-radius: 46% / 50%;
    isolation: isolate;
    backdrop-filter: blur(2px) saturate(1.05);
    -webkit-backdrop-filter: blur(2px) saturate(1.05);
    animation: portalPreviewFloat 5.5s ease-in-out infinite;
  }

  .portal-preview.entering .portal-preview-shell {
    animation: portalSpawnIn 700ms cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
  }
  .portal-preview.shrinking .portal-preview-shell {
    animation: none;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }
  .portal-preview.shrinking .portal-preview-core {
    animation: portalCorePreShrink 420ms cubic-bezier(0.12, 0.72, 0.24, 1) forwards;
  }
  .portal-preview.shrinking .portal-preview-core::after {
    animation: none;
  }
  .portal-preview.shrinking .portal-preview-image {
    animation: portalImageCompensate 420ms cubic-bezier(0.12, 0.72, 0.24, 1) forwards;
  }
  .portal-preview.entering .portal-preview-shell::after {
    animation: portalGlowIn 700ms ease-out forwards;
  }

  .portal-preview-core {
    border-radius: 43% 54% 46% 57% / 48% 55% 45% 52%;
    clip-path: inset(0% round 43% 54% 46% 57% / 48% 55% 45% 52%);
    -webkit-clip-path: inset(0% round 43% 54% 46% 57% / 48% 55% 45% 52%);
    transform: rotate(var(--portal-tilt));
  }
  .portal-preview-core::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    z-index: 1;
    background:
      radial-gradient(circle at 32% 24%, rgba(255, 255, 255, 0.22) 0%, transparent 38%),
      radial-gradient(circle at center, rgba(0, 0, 0, 0.05) 35%, rgba(0, 0, 0, 0.28) 100%);
    pointer-events: none;
  }
  .portal-preview.entering .portal-preview-core::before {
    animation: portalOverlayIn 700ms ease-out forwards;
  }
  .portal-preview-core::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    border-style: solid;
    border-color: rgba(242, 251, 255, 0.92);
    border-width: 3.5px 8.5px 4.5px 10px;
    z-index: 2;
    filter: drop-shadow(0 0 10px rgba(var(--portal-glow-rgb, 140, 206, 244), 0.72))
      drop-shadow(0 0 20px rgba(var(--portal-glow-rgb, 140, 206, 244), 0.48));
    pointer-events: none;
    transition: filter 0.22s ease;
  }
  .portal-preview:hover .portal-preview-core::after {
    filter: drop-shadow(0 0 18px rgba(var(--portal-glow-rgb, 140, 206, 244), 0.96))
      drop-shadow(0 0 34px rgba(var(--portal-glow-rgb, 140, 206, 244), 0.76))
      drop-shadow(0 0 54px rgba(var(--portal-glow-rgb, 140, 206, 244), 0.4));
  }
  .portal-preview.entering .portal-preview-core::after {
    animation: portalRingIn 700ms ease-out forwards;
  }

  .portal-preview-image {
    width: 100cqw;
    height: 100cqh;
    left: calc(50% - var(--portal-center-x));
    top: calc(50% - var(--portal-center-y));
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    transform: rotate(calc(var(--portal-tilt) * -1));
    transition: opacity 280ms ease;
  }

  .portal-preview-shell::after {
    content: '';
    position: absolute;
    inset: -36%;
    border-radius: 46% / 50%;
    background:
      radial-gradient(
        ellipse at center,
        rgba(255, 255, 255, 0.94) 0%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0.78) 14%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0.48) 28%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0.24) 42%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0.08) 54%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0) 66%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0) 100%
      ),
      radial-gradient(
        ellipse at center,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0.3) 0%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0.14) 36%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0.05) 52%,
        rgba(var(--portal-glow-rgb, 140, 206, 244), 0) 68%
      );
    filter: blur(22px);
    z-index: 0;
    pointer-events: none;
    transition:
      opacity 0.22s ease,
      filter 0.22s ease;
  }
  .portal-preview:hover .portal-preview-shell::after {
    opacity: 1;
    filter: blur(29px) saturate(1.2) brightness(1.16);
  }

  /* --- MENU CHROME --- */
  .menu-settings-view::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    background:
      radial-gradient(circle at 50% 53%, rgba(4, 8, 14, 0.34) 0%, rgba(4, 8, 14, 0.26) 36%, rgba(4, 8, 14, 0.14) 72%),
      linear-gradient(to bottom, rgba(4, 8, 14, 0.2) 0%, rgba(4, 8, 14, 0.28) 100%);
  }

  .menu-settings-panel::-webkit-scrollbar {
    width: 0;
    min-width: 6px;
  }
  .menu-settings-panel::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 999px;
  }
  .menu-settings-panel::-webkit-scrollbar-thumb {
    background: transparent;
    border-radius: 999px;
  }

  .menu-select-wrap select option {
    color: rgba(245, 249, 255, 0.95);
    background: rgba(12, 18, 30, 0.98);
  }

  /* Range slider pseudo-elements */
  .menu-range-slider::-webkit-slider-runnable-track {
    height: 0.8cqh;
    border-radius: 999px;
    background: rgba(245, 251, 255, 0.42);
  }
  .menu-range-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 1cqw;
    height: 1.8cqh;
    margin-top: -0.5cqh;
    border: 1px solid rgba(255, 255, 255, 0.85);
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.92);
  }
  .menu-range-slider::-moz-range-track {
    height: 0.8cqh;
    border-radius: 999px;
    background: rgba(245, 251, 255, 0.42);
  }
  .menu-range-slider::-moz-range-thumb {
    width: 1cqw;
    height: 1.8cqh;
    border: 1px solid rgba(255, 255, 255, 0.85);
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.92);
  }

  /* --- VIDEO CONTAINER --- */
  .video-container {
    container-type: size;
  }

  /* --- CONNECTION LOST OVERLAY --- */
  .connection-lost-overlay {
    transition:
      opacity 0.3s ease,
      visibility 0s ease 0.3s;
  }
  .connection-lost-overlay.active {
    transition:
      opacity 0.3s ease,
      visibility 0s ease 0s;
  }
  /* --- SERVER LOG DISPLAY --- */
  .server-log-content {
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 200, 100, 0.3) transparent;
  }
  .server-log-content::-webkit-scrollbar {
    width: 3px;
  }
  .server-log-content::-webkit-scrollbar-track {
    background: transparent;
  }
  .server-log-content::-webkit-scrollbar-thumb {
    background: rgba(255, 200, 100, 0.3);
    border-radius: 2px;
  }
  .server-log-content::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 200, 100, 0.5);
  }

  /* Terminal-display container override for choice dialog */
  .terminal-display:has(.engine-mode-choice) {
    position: absolute;
    inset: 0;
    top: 0;
    left: 0;
    transform: none;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* --- LOADING UI LAYER OVERRIDES --- */
  .loading-ui-layer.launch-revealing {
    pointer-events: none;
    clip-path: ellipse(6.6% 9.5% at 50% 53%);
    -webkit-clip-path: ellipse(6.6% 9.5% at 50% 53%);
    animation: portalBgReveal 960ms cubic-bezier(0.16, 0.86, 0.18, 1) forwards;
    will-change: clip-path, transform;
  }
  .loading-ui-layer.launch-concealing {
    pointer-events: none;
    clip-path: circle(160% at 50% 53%);
    -webkit-clip-path: circle(160% at 50% 53%);
    animation: portalBgConceal 600ms cubic-bezier(0.14, 0.76, 0.2, 1) forwards;
    will-change: clip-path, transform;
  }

  /* --- LOADING UI CQW/CQH ELEMENTS --- */
  .loading-output-handle {
    padding-top: 0.55cqh;
    padding-bottom: 0.1cqh;
  }
  .loading-output-handle-bar {
    width: 6.8cqw;
    min-width: 56px;
    max-width: 96px;
    height: 0.45cqh;
    background: rgba(255, 255, 255, 0.85);
    box-shadow: 0 0 4px rgba(255, 255, 255, 0.34);
  }
  .loading-output-handle.expanded .loading-output-handle-bar {
    background: rgba(255, 212, 212, 0.92);
  }
  .loading-inline-logs {
    width: min(76cqw, 820px);
    margin-top: 0.8cqh;
    transition:
      height 280ms ease,
      opacity 220ms ease,
      transform 280ms ease;
  }
  .loading-inline-logs.dragging {
    transition: none;
  }
  .loading-inline-logs-close {
    border: 1px solid rgba(255, 255, 255, 0.7);
    background: rgba(0, 0, 0, 0.45);
    color: rgba(255, 255, 255, 0.95);
    font-family: var(--font-serif);
    font-size: clamp(14px, 1.25cqw, 18px);
    padding: 0.35cqh 0.7cqw;
    cursor: pointer;
  }
}
